## 信息收集阶段

### 1、收集目标域名相关信息

#### 1、各类记录，dig(准确，权威)，nslookup（不太准确，非权威）（域传送）

+ ns记录：检查是否允许域传送，如果可传送，直接获取目标所有真实子域

+ mx记录：检查smtp，imap，pop3是否可以枚举邮件用户名

+ a记录：观察域名解析不到的ip，不一定是目标真实ip，尤其在挂了cdn后

#### 2、搜集所有可用目标子域

对大中型目标，直接从子域下手效果较好

#### 3、目标域名详细的whois信息

+ 管理员姓名
+ 管理员邮箱（先尝试在各种公开社工库查询该邮箱密码）
+ 电话
+ ns厂商（如果目标本身真的很难进，也可以从域名提供商入手）

### 2、收集目标ip相关信息

#### 1、是否用了cdn

如果用了先找到目标的真实ip段【bypasscdn】

#### 2、旁站收集

如果旁站可以秒，直接从旁站搞就可以，没必要在目标本身浪费太多时间

#### 3、实在没办法，则尝试c段，对大型目标可能好用

c段端口

c段web

#### 4、利用各种搜索引擎收集目标各种信息泄露

+ google 
+ bing
+ shodan
+ github
+ 其他的信息收集工具

### 3、搜集目标服务器基本信息

#### 1、目标服务器用的什么操作系统

win

linux

#### 2、目标用的那种web服务器，具体版本

+ 先手工测试下目标web服务器是否允许一些危险的请求方法（put、move、options）
+ Apache (2.2.x / 2.4.x)
+ Nginx
+ IIS(6.x / 7.x /8.x )
  + 尝试webdav写入及远程执行
  + 尝试短文件漏洞目录文件扫描
+ Tomcat(6.x / 7.x / 8.x)
  + 曾经出现的远程命令执行相对较多
  + 默认管理面板弱口令，直接部署webshell
+ Jboss远程命令执行
+ Resin
+ 是不是用的集成环境，这种环境下拿到的webshell权限较高
+ 有没有用均衡负载，可用lbd简单识别

#### 3、后端脚本具体用的又是啥，版本是多少

+ php
+ python
+ aspx.net
+ java / jsp
+ asp
+ ...

#### 4、是不是用的某种开源程序（CMS），如果是开源程序，对应的具体版本又是多少

+ wordpress俗称‘wp’
+ drupal俗称‘水滴’
+ joomla
+ discus
+ opencart
+ phpbb
+ 找对应版本的exp

#### 5、尽量弄清楚目标web程序具体是用什么框架开发的

+ Thinkphp
  + 曝光过不少漏洞
+ Strust2
  + 远程执行的0day较多

### 4、搜集并记录详细的目标服务器端口信息

#### 1、针对性端口渗透

+ 服务配置错误
+ 服务自身漏洞利用
+ 弱口令尝试直接在公网爆破

#### 2、相关工具

+ Masscan
+ zmap
+ nmap
+ 。。。

### 5、目标防护简单探测

#### 1、有没有waf，具体是什么类型的waf

#### 2、服务器防火墙有没有开，简单ping下目标域名

+ 一般windows只要开了防火墙默认就会禁止icmp
+ linux则不一定，有可能是iptables的原因，也有可能是在做内核优化时禁用了ICMP

### 6、收集目标邮箱

#### 1、稍微大一点的目标都会有自己的邮件服务器

即使使用的第三方的付费邮件服务也无所谓，因为我们只要邮箱

#### 2、走投无路的时候可以尝试发信

+ 直接发马（伪装成各种各样的钓鱼马）
+ 发钓鱼信[专门钓账号密码的那种]

#### 3、顺便将邮箱再拿到社工库里走一遍

把能查到的密码的邮箱详细记录下来，还是为后续的密码字典做信息积累